import{a0 as o}from"./framework.98e11516.js";class n{static isUndefined(e){return e===void 0}static pick(e,i){let s={};return i.forEach(t=>{s[t]=e[t]}),s}static omit(e,i){let s={};return Object.keys(e).forEach(t=>{i.indexOf(t)===-1&&(s[t]=e[t])}),s}static omitBy(e,i){let s={};return Object.keys(e).forEach(t=>{i(e[t])||(s[t]=e[t])}),s}static defaults(e,...i){i.forEach(s=>{Object.keys(s).forEach(t=>{(this.isUndefined(e[t])||e[t]==="")&&(e[t]=s[t])})})}}class d{constructor(){this.installed=!1,this.promise=Promise.resolve(),this.loaded={},this.props=["unload","src","type","async","integrity","text","crossorigin"]}install(e){e.config.globalProperties.$scriptx=this;let i=this;i.installed||(e.component("scriptx",{props:i.props,render(){return o("div",{style:"display:none"},this.$slots.default?this.$slots.default():void 0)},mounted(){let s=this.$el.parentElement;if(!this.src)i.promise=i.promise.then(()=>{let t=document.createElement("script"),r=this.$el.innerHTML;r=r.replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&amp;/gi,"&"),t.type="text/javascript",t.appendChild(document.createTextNode(r)),s.appendChild(t),this.$emit("loaded")});else{let t=n.omitBy(n.pick(this,i.props),n.isUndefined);t.parent=s;let r=()=>{i.load(this.src,t).then(()=>this.$emit("loaded"),a=>this.$emit("error",a))};n.isUndefined(this.async)||this.async==="false"?i.promise=i.promise.then(r):r()}this.$nextTick(()=>{this.$el.parentElement.removeChild(this.$el)})},unmounted(){this.unload&&(new Function(this.unload)(),delete i.loaded[this.src])}}),i.installed=!0)}load(e,i={parent:document.head}){return this.loaded[e]||(this.loaded[e]=new Promise((s,t)=>{let r=document.createElement("script");n.defaults(r,n.omit(i,["unload","parent"]),{type:"text/javascript"}),r.async=!1,r.src=e,i.crossorigin&&(r.crossOrigin=i.crossorigin),r.onload=()=>s(e),r.onerror=()=>t(new Error(e)),i.parent.appendChild(r)})),this.loaded[e]}}const p=new d;export{p as default};
